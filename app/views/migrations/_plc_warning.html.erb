<%# Enhanced PLC Stage Warning - Point of No Return %>

<div class="plc-danger-zone mb-4">
  <%# CRITICAL WARNING BANNER %>
  <div class="bg-danger text-white p-4 rounded-3 mb-3 shadow">
    <div class="d-flex align-items-center gap-3 mb-3">
      <span class="fs-1">üö®</span>
      <div>
        <h2 class="mb-0 fw-bold" style="font-size: 28px;">POINT OF NO RETURN</h2>
        <p class="mt-2 mb-0 fs-6 opacity-75">
          The next action will permanently redirect your DID to the new PDS
        </p>
      </div>
    </div>

    <div class="bg-white bg-opacity-10 p-3 rounded border-start border-3 border-white border-opacity-50">
      <p class="mb-0 small lh-lg">
        <strong>Once you submit the PLC token:</strong><br>
        ‚Ä¢ Your DID (<code class="bg-white bg-opacity-25 px-1 rounded-1"><%= @migration.did %></code>) will point to <%= @migration.new_pds_host %><br>
        ‚Ä¢ All AT Protocol apps will resolve your identity to the new PDS<br>
        ‚Ä¢ This change is immediate and affects the entire federated network<br>
        ‚Ä¢ <strong>This action CANNOT be undone</strong> without your rotation key
      </p>
    </div>
  </div>

  <%# WHAT YOU NEED SECTION %>
  <div class="alert alert-warning border-start border-4 border-warning mb-3">
    <h3 class="text-dark fs-5 mb-2">
      üìã What You Need Before Proceeding:
    </h3>
    <ul class="text-dark small mb-0 lh-lg">
      <li><strong>Your rotation key saved securely</strong> (scroll up to copy it)</li>
      <li><strong>Verified all your data migrated</strong> (repository, blobs, preferences)</li>
      <li><strong>The PLC operation token</strong> (will be sent to your email from <%= @migration.old_pds_host %>)</li>
      <li><strong>Understanding this is irreversible</strong> without the rotation key</li>
    </ul>
  </div>

  <%# INSTRUCTIONS %>
  <div class="card border-2 mb-3">
    <div class="card-body p-4">
      <h3 class="text-dark fs-5 mb-3">
        Step-by-Step Instructions:
      </h3>

      <div class="mb-3">
        <div class="d-flex align-items-start gap-3 mb-3">
          <div class="btn-gradient rounded-circle d-flex align-items-center justify-content-center flex-shrink-0" style="width: 32px; height: 32px;">1</div>
          <div class="flex-grow-1">
            <strong class="text-dark">Save Your Rotation Key</strong>
            <p class="text-secondary small mt-1 mb-0">
              Scroll up and copy your rotation key to a secure location (password manager, encrypted file).
              This is your ONLY way to recover if something goes wrong.
            </p>
          </div>
        </div>

        <div class="d-flex align-items-start gap-3 mb-3">
          <div class="btn-gradient rounded-circle d-flex align-items-center justify-content-center flex-shrink-0" style="width: 32px; height: 32px;">2</div>
          <div class="flex-grow-1">
            <strong class="text-dark">Check Your Email</strong>
            <p class="text-secondary small mt-1 mb-0">
              Your old PDS provider (<strong><%= @migration.old_pds_host %></strong>) has been asked to send you a PLC operation token via email.
              Check your inbox for an email containing the token.
            </p>
          </div>
        </div>

        <div class="d-flex align-items-start gap-3 mb-3">
          <div class="btn-gradient rounded-circle d-flex align-items-center justify-content-center flex-shrink-0" style="width: 32px; height: 32px;">3</div>
          <div class="flex-grow-1">
            <strong class="text-dark">Copy the PLC Token</strong>
            <p class="text-secondary small mt-1 mb-0">
              Copy the PLC operation token from the email sent by your old PDS provider.
              The token will look like a long string of characters.
            </p>
          </div>
        </div>

        <div class="d-flex align-items-start gap-3">
          <div class="btn-gradient rounded-circle d-flex align-items-center justify-content-center flex-shrink-0" style="width: 32px; height: 32px;">4</div>
          <div class="flex-grow-1">
            <strong class="text-dark">Submit the Token Below</strong>
            <p class="text-secondary small mt-1 mb-0">
              Paste the PLC token in the form below and submit to complete your migration.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <%# FINAL WARNING BEFORE FORM %>
  <div class="alert alert-danger border-danger border-2 mb-4">
    <div class="d-flex align-items-center gap-3 mb-2">
      <span class="fs-3">‚ö†Ô∏è</span>
      <h3 class="text-danger-emphasis mb-0 fs-5 fw-bold">
        Final Warning: Are You Ready?
      </h3>
    </div>
    <ul class="text-danger-emphasis small mb-0 lh-lg">
      <li>Have you saved your rotation key in a secure location?</li>
      <li>Do you understand this change is permanent and affects the entire AT Protocol network?</li>
      <li>Are you prepared to lose access if you don't have your rotation key?</li>
      <li>Have you verified all your data (posts, media, preferences) migrated successfully?</li>
    </ul>
    <p class="text-danger-emphasis small mt-2 mb-0 fw-semibold">
      If you answered NO to any of these questions, DO NOT proceed yet.
    </p>
  </div>
</div>
